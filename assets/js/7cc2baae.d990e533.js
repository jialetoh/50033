"use strict";(self.webpackChunksite_docusaurus_template=self.webpackChunksite_docusaurus_template||[]).push([[4443],{82223:(e,t,n)=>{n.d(t,{A:()=>o});n(96540);var s=n(18215);const a={tabItem:"tabItem_Ymn6"};var i=n(74848);function o(e){let{children:t,hidden:n,className:o}=e;return(0,i.jsx)("div",{role:"tabpanel",className:(0,s.A)(a.tabItem,o),hidden:n,children:t})}},72206:(e,t,n)=>{n.d(t,{A:()=>v});var s=n(96540),a=n(18215),i=n(80052),o=n(56347),r=n(35793),l=n(99025),c=n(4430),d=n(44148);function h(e){return s.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,s.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:t,children:n}=e;return(0,s.useMemo)((()=>{const e=t??function(e){return h(e).map((e=>{let{props:{value:t,label:n,attributes:s,default:a}}=e;return{value:t,label:n,attributes:s,default:a}}))}(n);return function(e){const t=(0,c.XI)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function u(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function m(e){let{queryString:t=!1,groupId:n}=e;const a=(0,o.W6)(),i=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,l.aZ)(i),(0,s.useCallback)((e=>{if(!i)return;const t=new URLSearchParams(a.location.search);t.set(i,e),a.replace({...a.location,search:t.toString()})}),[i,a])]}function x(e){const{defaultValue:t,queryString:n=!1,groupId:a}=e,i=p(e),[o,l]=(0,s.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!u({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const s=n.find((e=>e.default))??n[0];if(!s)throw new Error("Unexpected error: 0 tabValues");return s.value}({defaultValue:t,tabValues:i}))),[c,h]=m({queryString:n,groupId:a}),[x,b]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[a,i]=(0,d.Dv)(n);return[a,(0,s.useCallback)((e=>{n&&i.set(e)}),[n,i])]}({groupId:a}),f=(()=>{const e=c??x;return u({value:e,tabValues:i})?e:null})();(0,r.A)((()=>{f&&l(f)}),[f]);return{selectedValue:o,selectValue:(0,s.useCallback)((e=>{if(!u({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);l(e),h(e),b(e)}),[h,b,i]),tabValues:i}}var b=n(75251);const f={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var j=n(74848);function g(e){let{className:t,block:n,selectedValue:s,selectValue:o,tabValues:r}=e;const l=[],{blockElementScrollPositionUntilNextRender:c}=(0,i.a_)(),d=e=>{const t=e.currentTarget,n=l.indexOf(t),a=r[n].value;a!==s&&(c(t),o(a))},h=e=>{let t=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const n=l.indexOf(e.currentTarget)+1;t=l[n]??l[0];break}case"ArrowLeft":{const n=l.indexOf(e.currentTarget)-1;t=l[n]??l[l.length-1];break}}t?.focus()};return(0,j.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.A)("tabs",{"tabs--block":n},t),children:r.map((e=>{let{value:t,label:n,attributes:i}=e;return(0,j.jsx)("li",{role:"tab",tabIndex:s===t?0:-1,"aria-selected":s===t,ref:e=>{l.push(e)},onKeyDown:h,onClick:d,...i,className:(0,a.A)("tabs__item",f.tabItem,i?.className,{"tabs__item--active":s===t}),children:n??t},t)}))})}function y(e){let{lazy:t,children:n,selectedValue:i}=e;const o=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=o.find((e=>e.props.value===i));return e?(0,s.cloneElement)(e,{className:(0,a.A)("margin-top--md",e.props.className)}):null}return(0,j.jsx)("div",{className:"margin-top--md",children:o.map(((e,t)=>(0,s.cloneElement)(e,{key:t,hidden:e.props.value!==i})))})}function w(e){const t=x(e);return(0,j.jsxs)("div",{className:(0,a.A)("tabs-container",f.tabList),children:[(0,j.jsx)(g,{...t,...e}),(0,j.jsx)(y,{...t,...e})]})}function v(e){const t=(0,b.A)();return(0,j.jsx)(w,{...e,children:h(e.children)},String(t))}},44995:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>c,default:()=>u,frontMatter:()=>l,metadata:()=>s,toc:()=>h});const s=JSON.parse('{"id":"babies/physics","title":"Physics2D","description":"The goal of this section is to create some obstacles (breakable boxes, platforms, static blocks, pipes) that exists in Super Mario Bros. Using this, we will learn more about Unity\'s Physics2D Engine and manage our GameObjects by creating Prefabs (a sort of reusable object).","source":"@site/docs/02-babies/physics.md","sourceDirName":"02-babies","slug":"/babies/physics","permalink":"/50033/docs/babies/physics","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Camera Movement","permalink":"/50033/docs/babies/camera"},"next":{"title":"Checkoff","permalink":"/50033/docs/babies/checkoff"}}');var a=n(74848),i=n(28453),o=(n(53398),n(19894),n(88761)),r=(n(89166),n(384));n(72206),n(82223);const l={sidebar_position:2},c="Physics2D",d={},h=[{value:"Alternative: Unity Tilemap",id:"alternative-unity-tilemap",level:2},{value:"Constraint Z-Rotation",id:"constraint-z-rotation",level:2},{value:"Prefab",id:"prefab",level:2},{value:"Bricks and Question Box",id:"bricks-and-question-box",level:3},{value:"Pipes",id:"pipes",level:3},{value:"Goomba",id:"goomba",level:3},{value:"Unpack Prefab",id:"unpack-prefab",level:3},{value:"Layers",id:"layers",level:2},{value:"Layer-based Collision",id:"layer-based-collision",level:3},{value:"Collision with Obstacle or Pipes",id:"collision-with-obstacle-or-pipes",level:3},{value:"More Tags",id:"more-tags",level:3},{value:"LayerMask",id:"layermask",level:3},{value:"Profiler",id:"profiler",level:2},{value:"Physics 2D",id:"physics-2d",level:2},{value:"Effector2D",id:"effector2d",level:3},{value:"PhysicsJoint2D",id:"physicsjoint2d",level:3},{value:"Springy Question Box",id:"springy-question-box",level:3},{value:"Physics Material 2D",id:"physics-material-2d",level:3}];function p(e){const t={a:"a",admonition:"admonition",annotation:"annotation",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",math:"math",mdxAdmonitionTitle:"mdxAdmonitionTitle",mn:"mn",mo:"mo",mrow:"mrow",ol:"ol",p:"p",pre:"pre",semantics:"semantics",span:"span",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"physics2d",children:"Physics2D"})}),"\n",(0,a.jsx)(t.p,{children:"The goal of this section is to create some obstacles (breakable boxes, platforms, static blocks, pipes) that exists in Super Mario Bros. Using this, we will learn more about Unity's Physics2D Engine and manage our GameObjects by creating Prefabs (a sort of reusable object)."}),"\n",(0,a.jsx)(t.h2,{id:"alternative-unity-tilemap",children:"Alternative: Unity Tilemap"}),"\n",(0,a.jsxs)(t.p,{children:["In this section, we\u2019ll focus on building a 2D platformer using ",(0,a.jsx)(t.strong,{children:"individual"})," ",(0,a.jsx)(t.strong,{children:"sprites"})," to introduce key concepts like ",(0,a.jsx)(t.strong,{children:"Physics2D"})," and character movement, giving us a solid foundation in Unity's 2D game development tools."]}),"\n",(0,a.jsx)(t.admonition,{type:"info",children:(0,a.jsxs)(t.p,{children:["Sprites serve as the ",(0,a.jsx)("span",{className:"orange-bold",children:"visual"})," representations for objects, while Physics2D defines their ",(0,a.jsx)("span",{className:"orange-bold",children:"movement"}),", ",(0,a.jsx)("span",{className:"orange-bold",children:"collisions"}),", and ",(0,a.jsx)("span",{className:"orange-bold",children:"interactions"})," in the game world."]})}),"\n",(0,a.jsxs)(t.p,{children:["While we'll work with ",(0,a.jsx)(t.strong,{children:"sprites"})," for clarity and flexibility, ",(0,a.jsx)(t.a,{href:"https://learn.unity.com/tutorial/introduction-to-tilemaps",children:"Unity's Tilemap system"})," is an excellent alternative for creating grid-based environments efficiently. Once you grasp the basics, you can explore Tilemap to streamline level design and enhance your workflow for more complex projects."]}),"\n",(0,a.jsxs)(t.admonition,{type:"note",children:[(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.strong,{children:"To Use Tilemap:"})," Tilemap is great for grid-based level design, offering efficient editing, automated tile placement, and optimised performance with fewer draw calls. It's ideal for modular, repetitive environments in 2D platformers."]}),(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.strong,{children:"Not to Use Tilemap:"})," For detailed, non-repetitive, or dynamic environments, custom solutions like individual sprites or procedural generation offer more creative freedom but require more effort and may impact performance."]})]}),"\n",(0,a.jsxs)(t.p,{children:["Super Mario Bros-style games are best suited for Unity's Tilemap system, as it simplifies creating grid-based levels with ",(0,a.jsx)(t.strong,{children:"reusable"})," tiles, ",(0,a.jsx)(t.strong,{children:"built-in collision handling"}),", and ",(0,a.jsx)(t.strong,{children:"efficient"})," performance."]}),"\n",(0,a.jsx)(t.p,{children:"However, we\u2019ll still use Physics2D with sprites here to facilitate learning, as it provides a clear understanding of movement, collisions, and interactions without relying on Tilemap-specific tools."}),"\n",(0,a.jsx)(t.h2,{id:"constraint-z-rotation",children:"Constraint Z-Rotation"}),"\n",(0,a.jsx)(t.p,{children:"Notice how we always need Mario to stand upright, and not toppling when moving too fast. We definitely do not want Mario to topple when hitting other obstacles as well like this:"}),"\n",(0,a.jsx)(r.A,{path:"https://50033.s3.ap-southeast-1.amazonaws.com/week-2/topple.mp4",widthPercentage:"100%"}),"\n",(0,a.jsx)(t.p,{children:"In order to keep Mario standing upright, we need to place constraints on Mario\u2019s Rigidbody2D Z-rotation component. From this screenshot, it should be pretty clear that we want Mario's position (x,y) to vary but not his Z-rotation:"}),"\n",(0,a.jsx)(o.A,{path:n(89594).A,widthPercentage:"100%"}),"\n",(0,a.jsx)(t.h2,{id:"prefab",children:"Prefab"}),"\n",(0,a.jsxs)(t.p,{children:["In Unity\u2019s Prefab system, Prefab Assets act as ",(0,a.jsx)(t.strong,{children:"templates"}),"."]}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"You create Prefab Assets in the Editor, and they are saved as an Asset in the Project window"}),"\n",(0,a.jsx)(t.li,{children:"From Prefab Assets, you can create any number of Prefab instances."}),"\n",(0,a.jsx)(t.li,{children:"Prefab instances can either be created in the editor and saved as part of your Scenes or instantiated at runtime."}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:"Why do we need to create Prefabs instead of regular GameObjects? To understand fully, create some obstacles for Mario."}),"\n",(0,a.jsx)(t.h3,{id:"bricks-and-question-box",children:"Bricks and Question Box"}),"\n",(0,a.jsx)(t.p,{children:"Now that our Mario can move around smoothly with proper animations, it\u2019s time we add some obstacles. Adding bricks that Mario can jump on is easy: simply add Box Collider 2D element on every Brick and Question Box GameObject."}),"\n",(0,a.jsx)(o.A,{path:n(4428).A,widthPercentage:"100%"}),"\n",(0,a.jsxs)(t.p,{children:["The ",(0,a.jsx)("span",{className:"orange-bold",children:"problem"})," is that we have ",(0,a.jsx)(t.strong,{children:"so many copies"})," of those boxes and bricks in the game. We definitely do not want to manually add collider to all of them. To fix this, we need to create a ",(0,a.jsx)(t.strong,{children:"Prefab"})," of that brick and question box by ",(0,a.jsx)(t.strong,{children:"dragging"})," that GameObject into the Prefab folder. This recording should give you the idea:"]}),"\n",(0,a.jsx)(r.A,{path:"https://50033.s3.ap-southeast-1.amazonaws.com/week-2/prefab.mp4",widthPercentage:"100%"}),"\n",(0,a.jsxs)(t.blockquote,{children:["\n",(0,a.jsxs)(t.p,{children:["From the ",(0,a.jsx)(t.a,{href:"https://docs.unity3d.com/Manual/Prefabs.html",children:"documentation"}),": Unity\u2019s Prefab system allows you to ",(0,a.jsx)(t.strong,{children:"create"}),", ",(0,a.jsx)(t.strong,{children:"configure"}),", and ",(0,a.jsx)(t.strong,{children:"store"})," a GameObject complete with all its components, property values, and child GameObjects as a ",(0,a.jsx)("span",{className:"orange-bold",children:"reusable"})," Asset. The Prefab Asset acts as a template from which you can create new Prefab instances in the Scene."]}),"\n"]}),"\n",(0,a.jsxs)(t.p,{children:["We have the ",(0,a.jsx)(t.code,{children:"Brick"})," and ",(0,a.jsx)(t.code,{children:"Question Box"})," prefab now, and we can duplicate it across the Scene wherever we want to spawn it. Also, ",(0,a.jsxs)(t.a,{href:"https://docs.unity3d.com/Manual/EditingInPrefabMode.html",children:["a change made in the ",(0,a.jsx)(t.strong,{children:"Prefab"})," in the ",(0,a.jsx)(t.strong,{children:"Prefab Mode"})]})," will be applied across all prefabs. You can still however have Prefab ",(0,a.jsx)(t.a,{href:"https://docs.unity3d.com/Manual/PrefabVariants.html",children:"variants"})," or ",(0,a.jsx)(t.a,{href:"https://docs.unity3d.com/Manual/PrefabInstanceOverrides.html",children:"override"})," existing Prefab in the Scene if you want it to differ slightly from the base prefab template."]}),"\n",(0,a.jsx)(t.admonition,{title:"warning",type:"caution",children:(0,a.jsxs)(t.p,{children:["Please do not skip the ",(0,a.jsx)(t.a,{href:"https://docs.unity3d.com/Manual/Prefabs.html",children:"documentation"})," and read them carefully."]})}),"\n",(0,a.jsx)(t.h3,{id:"pipes",children:"Pipes"}),"\n",(0,a.jsx)(t.p,{children:"Create the pipes prefabs too, setting the appropriate colliders so Mario can collide with it and climb on it. Pipe's Head shape isn't exactly rectangular, so you can use either of the two methods:"}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsxs)(t.strong,{children:["Two ",(0,a.jsx)(t.code,{children:"BoxCollider2D"})]}),":"]}),"\n",(0,a.jsx)(o.A,{path:n(3465).A,widthPercentage:"100%"}),"\n",(0,a.jsxs)(t.p,{children:["Using one ",(0,a.jsx)(t.strong,{children:(0,a.jsx)(t.code,{children:"PollygonCollider2D"})}),", adjusting the shape to fit the Pipe head sprite:"]}),"\n",(0,a.jsx)(r.A,{path:"https://50033.s3.ap-southeast-1.amazonaws.com/week-2/pollygoncollider.mp4",widthPercentage:"100%"}),"\n",(0,a.jsx)(t.h3,{id:"goomba",children:"Goomba"}),"\n",(0,a.jsx)(t.p,{children:"Goomba should also be set as a prefab since we will spawn many of them at once. In the end, check that you have the following Prefabs:"}),"\n",(0,a.jsx)(o.A,{path:n(69524).A,widthPercentage:"100%"}),"\n",(0,a.jsx)(t.h3,{id:"unpack-prefab",children:"Unpack Prefab"}),"\n",(0,a.jsx)(t.p,{children:"If you no longer want one of your GameObject to be associated with a prefab, simply right click on the GameObject in the Hierarchy and select Prefab >> Unpack Completely:"}),"\n",(0,a.jsx)(o.A,{path:n(64258).A,widthPercentage:"50%"}),"\n",(0,a.jsx)(t.h2,{id:"layers",children:"Layers"}),"\n",(0,a.jsxs)(t.p,{children:["We can create ",(0,a.jsx)(t.code,{children:"Layers"})," via the Inspector of any GameObject to determine:"]}),"\n",(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsx)(t.li,{children:"What can be rendered (layer-based rendering)"}),"\n",(0,a.jsx)(t.li,{children:"What can collide with each other (layer-based collision)"}),"\n"]}),"\n",(0,a.jsxs)(t.p,{children:["For ",(0,a.jsx)(t.strong,{children:"layer-based rendering"}),", we can decide what to be rendered (only a selection of layers) using the Camera's ",(0,a.jsx)(t.code,{children:"culling mask"}),". Unselecting a particular layer in the Camera's culling mask property will omit it from being rendered in the Game Scene. Our focus now is the second point: layer-based collision. We need to decide what can collide with which object. For example, we:"]}),"\n",(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsx)(t.li,{children:"Do not need Unity to compute collision between the Pipe's top head with the pipe's body"}),"\n",(0,a.jsx)(t.li,{children:"Do not need Unity to compute collision between the Pipe's body and the ground"}),"\n",(0,a.jsx)(t.li,{children:"Do not need Unity to trigger collision between Goomba and any of the obstacles or ground"}),"\n"]}),"\n",(0,a.jsx)(t.h3,{id:"layer-based-collision",children:"Layer-based Collision"}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.strong,{children:"Create"})," two other layers via any GameObject Inspector: ",(0,a.jsx)(t.code,{children:"Enemies"})," and ",(0,a.jsx)(t.code,{children:"Obstacles"}),"."]}),"\n",(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsxs)(t.li,{children:["Set ",(0,a.jsx)(t.code,{children:"Pipes"})," GameObject Layer to ",(0,a.jsx)(t.code,{children:"Obstacles"}),"."]}),"\n",(0,a.jsxs)(t.li,{children:["Set ",(0,a.jsx)(t.code,{children:"Obstacles"})," GameObject Layer to ",(0,a.jsx)(t.code,{children:"Obstacles"})," too."]}),"\n",(0,a.jsxs)(t.li,{children:["Set all ",(0,a.jsx)(t.code,{children:"Enemies"})," GameObject Layer to ",(0,a.jsx)(t.code,{children:"Enemies"}),"."]}),"\n"]}),"\n",(0,a.jsxs)(t.blockquote,{children:["\n",(0,a.jsxs)(t.p,{children:["Apply it to all their ",(0,a.jsx)(t.strong,{children:"children"}),"."]}),"\n"]}),"\n",(0,a.jsx)(t.admonition,{type:"warning",children:(0,a.jsx)(t.p,{children:"Setting the Prefab changes via the Scene instead of Prefab Mode only applies to that instance of that Prefab. This discrepancy is highlighted clearly in the Hierarchy. You can then choose to update the prefab to follow your changes."})}),"\n",(0,a.jsxs)(t.p,{children:["Then open ",(0,a.jsx)(t.strong,{children:"Project Settings"})," (Edit >> Project Settings) and set the collision matrix as such. If you untick the boxes that means Unity will ignore collisions between those layers:"]}),"\n",(0,a.jsx)(o.A,{path:n(56584).A,widthPercentage:"100%"}),"\n",(0,a.jsx)(t.p,{children:"Here's the complete walkthrough:"}),"\n",(0,a.jsx)(r.A,{path:"https://50033.s3.ap-southeast-1.amazonaws.com/week-2/collision-layer.mp4",widthPercentage:"100%"}),"\n",(0,a.jsx)(t.h3,{id:"collision-with-obstacle-or-pipes",children:"Collision with Obstacle or Pipes"}),"\n",(0,a.jsxs)(t.p,{children:["In ",(0,a.jsx)(t.code,{children:"PlayerMovement.cs"}),", we have yet to take into account that Mario can land on top of a Pipe or a Box. This is what happens:"]}),"\n",(0,a.jsx)(r.A,{path:"https://50033.s3.ap-southeast-1.amazonaws.com/week-2/mario-cant-jump.mp4",widthPercentage:"100%"}),"\n",(0,a.jsx)(t.h3,{id:"more-tags",children:"More Tags"}),"\n",(0,a.jsxs)(t.p,{children:["We can fix that by checking for collision against ",(0,a.jsx)(t.code,{children:"Obstacles"})," and ",(0,a.jsx)(t.code,{children:"Pipes"})," too. Sure, we can ",(0,a.jsx)(t.strong,{children:"add"})," ",(0,a.jsx)(t.code,{children:"Tag"})," to each pipe and each Goomba and do the following check:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-cs",metastring:'title="PlayerMovement.cs"',children:'\n    void OnCollisionEnter2D(Collision2D col)\n    {\n\n        if ((col.gameObject.CompareTag("Ground") || col.gameObject.CompareTag("Enemies") || col.gameObject.CompareTag("Obstacles")) && !onGroundState)\n        {\n            onGroundState = true;\n            // update animator state\n            marioAnimator.SetBool("onGround", onGroundState);\n        }\n\n    }\n\n'})}),"\n",(0,a.jsx)(t.admonition,{type:"note",children:(0,a.jsxs)(t.p,{children:["The usage of Tag can be controversial sometimes, with some complaining that it's not resource efficient and whatever but there's no denying that it is ",(0,a.jsx)("span",{className:"orange-bold",children:"convenient"}),", especially in prototyping stage right now (yes, you're building a game in less than 2 months, that's just a prototype)."]})}),"\n",(0,a.jsx)(t.h3,{id:"layermask",children:"LayerMask"}),"\n",(0,a.jsxs)(t.p,{children:["However, let's be a little fancier. Although Layers are essential (to avoid extra computation on collision and unwanted collision behavior, etc), we don't want to manually ",(0,a.jsx)(t.code,{children:"Tag"})," every GameObject in our Scene."]}),"\n",(0,a.jsx)(t.admonition,{type:"warning",children:(0,a.jsxs)(t.p,{children:["Please note that ",(0,a.jsx)(t.code,{children:"CompareTag"})," is really fast, and there's nothing wrong with the code above in terms of performance! We do not discard it for performance reason, but simply ",(0,a.jsx)(t.em,{children:"preference"})," and extra convenience (not having to add Tags). Making a functional game is hard enough. If you don't have performance issues, ",(0,a.jsx)(t.strong,{children:"do not blatantly attempt to optimise"}),". Code readability and modularity is more important than that."]})}),"\n",(0,a.jsxs)(t.p,{children:["Every ",(0,a.jsx)(t.strong,{children:"layer"})," that we set the GameObject to is represented by an ",(0,a.jsx)(t.strong,{children:"integer"}),":"]}),"\n",(0,a.jsx)(o.A,{path:n(7541).A,widthPercentage:"50%"}),"\n",(0,a.jsxs)(t.p,{children:["We can then ",(0,a.jsx)(t.strong,{children:"create"})," a 32-bit ",(0,a.jsx)(t.a,{href:"https://docs.unity3d.com/ScriptReference/LayerMask.html",children:"LayerMask"}),", a ",(0,a.jsx)(t.strong,{children:"one-hot"})," mapping of Layer id to a 32-bit value as such:"]}),"\n",(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"Ground"})," is ",(0,a.jsx)(t.code,{children:"0x00000008"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:["This translate to ",(0,a.jsx)(t.code,{children:"0000 1000"})," in binary (leading zeroes are omitted)"]}),"\n",(0,a.jsxs)(t.li,{children:["The value ",(0,a.jsx)(t.code,{children:"1"})," lies on the 3rd bit from the right (we count from 0, so 0th bit from the right is the LSB)"]}),"\n",(0,a.jsxs)(t.li,{children:["You can create this binary value using leftshift operation: ",(0,a.jsx)(t.code,{children:"int groundMask = 1 << 3"})]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"Enemies"})," is ",(0,a.jsx)(t.code,{children:"0x00000040"})]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"Obstacles"})," is ",(0,a.jsx)(t.code,{children:"0x00000080"})]}),"\n"]}),"\n",(0,a.jsxs)(t.p,{children:["To check if ",(0,a.jsx)(t.code,{children:"LayerX"})," hits ",(0,a.jsx)(t.code,{children:"LayerY"}),", we simply perform a bitwise ",(0,a.jsx)(t.code,{children:"AND"})," between them and check if the resulting value is ",(0,a.jsxs)(t.span,{className:"katex",children:[(0,a.jsx)(t.span,{className:"katex-mathml",children:(0,a.jsx)(t.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(t.semantics,{children:[(0,a.jsxs)(t.mrow,{children:[(0,a.jsx)(t.mo,{children:">"}),(0,a.jsx)(t.mn,{children:"0"})]}),(0,a.jsx)(t.annotation,{encoding:"application/x-tex",children:">0"})]})})}),(0,a.jsxs)(t.span,{className:"katex-html","aria-hidden":"true",children:[(0,a.jsxs)(t.span,{className:"base",children:[(0,a.jsx)(t.span,{className:"strut",style:{height:"0.5782em",verticalAlign:"-0.0391em"}}),(0,a.jsx)(t.span,{className:"mrel",children:">"}),(0,a.jsx)(t.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,a.jsxs)(t.span,{className:"base",children:[(0,a.jsx)(t.span,{className:"strut",style:{height:"0.6444em"}}),(0,a.jsx)(t.span,{className:"mord",children:"0"})]})]})]}),"."]}),"\n",(0,a.jsxs)(t.p,{children:["We can modify ",(0,a.jsx)(t.code,{children:"PlayerMovement.cs"})," into this:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-cs",metastring:'title="PlayerMovement.cs"',children:'    //highlight-start\n    int collisionLayerMask = (1 << 3) | (1 << 6) | (1 << 7);\n//highlight-end\n    void OnCollisionEnter2D(Collision2D col)\n    {\n        //highlight-start\n\n        if (((collisionLayerMask & (1 << col.transform.gameObject.layer)) > 0) & !onGroundState)\n        {\n            onGroundState = true;\n            // update animator state\n            marioAnimator.SetBool("onGround", onGroundState);\n        }\n//highlight-end\n    }\n'})}),"\n",(0,a.jsxs)(t.admonition,{type:"playtest",children:[(0,a.jsx)(t.p,{children:"The resulting behavior should be as follows, where Mario can now climb obstacles (both boxes and pipes):"}),(0,a.jsx)(r.A,{path:"https://50033.s3.ap-southeast-1.amazonaws.com/week-2/mario-can-climb.mp4",widthPercentage:"100%"})]}),"\n",(0,a.jsx)(t.h2,{id:"profiler",children:"Profiler"}),"\n",(0,a.jsxs)(t.p,{children:["If you ",(0,a.jsx)(t.em,{children:"really"})," want to optimise your game, or feel like some part has high latency, you can use Unity's Profiler to identify the root cause of the heavy computations. Select Window >> Analysis >> Profiler, and begin recording your gameplay."]}),"\n",(0,a.jsx)(r.A,{path:"https://50033.s3.ap-southeast-1.amazonaws.com/week-2/profiler.mp4",widthPercentage:"100%"}),"\n",(0,a.jsxs)(t.p,{children:["Notice that it reports CPU usage at 33ms (30FPS) because we did set the game to play at 30FPS under the ",(0,a.jsx)(t.code,{children:"Start()"})," method of ",(0,a.jsx)(t.code,{children:"PlayerMovement.cs"}),". The rest of the results are pretty straightforward to inspect. You can ",(0,a.jsx)(t.a,{href:"https://www.youtube.com/watch?v=uXRURWwabF4",children:"watch the official guide"})," here, but this is not part of our syllabus. We just want to show you the recommended way to even have an idea on ",(0,a.jsx)(t.em,{children:"where"})," to optimise instead of optimising stuffs blindly."]}),"\n",(0,a.jsx)(t.h2,{id:"physics-2d",children:"Physics 2D"}),"\n",(0,a.jsxs)(t.p,{children:["Unity's Physics 2D engine handles 2D physics and optimises them. You don't have to reinvent the wheels. In this section, we briefly introduce to you three more components: ",(0,a.jsx)(t.strong,{children:"Effectors"}),", ",(0,a.jsx)(t.strong,{children:"Joints"}),", and ",(0,a.jsx)(t.strong,{children:"Materials"}),". Please read the ",(0,a.jsx)(t.a,{href:"https://docs.unity3d.com/Manual/Physics2DReference.html",children:"documentation"})," for a more detailed usage."]}),"\n",(0,a.jsx)(t.h3,{id:"effector2d",children:"Effector2D"}),"\n",(0,a.jsxs)(t.p,{children:["Suppose you want to create a platform that allows only one-way collision. You can upgrade your 2DColliders to be used with a new component called ",(0,a.jsx)(t.a,{href:"https://docs.unity3d.com/Manual/Effectors2D.html",children:"effectors"}),". To demonstrate how this works, let\u2019s create a platform where Mario can \u201cclimb onto\u201d from underneath it but can stay upright on top of it."]}),"\n",(0,a.jsxs)(t.blockquote,{children:["\n",(0,a.jsx)(t.p,{children:"Yes, World 1-1 in Super Mario Bros doesn't have this item, but we are just going to build it here for learning sake."}),"\n"]}),"\n",(0,a.jsxs)(t.p,{children:["Create a ",(0,a.jsx)(t.code,{children:"platform"})," GameObject, and place it under Obstacles GameObject. Then,"]}),"\n",(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsxs)(t.li,{children:["Add a ",(0,a.jsx)(t.code,{children:"SpriteRenderer"})," with ",(0,a.jsx)(t.code,{children:"moving_platform_6"})," as sprite"]}),"\n",(0,a.jsxs)(t.li,{children:["Add EdgeCollider2D and place it just at the top edge of the sprite. Tick the ",(0,a.jsx)(t.code,{children:"Used By Effector"})," property"]}),"\n",(0,a.jsxs)(t.li,{children:["Add ",(0,a.jsx)(t.code,{children:"PlatformEffector2D"})," and set the ",(0,a.jsx)(t.code,{children:"SurfaceArc"})," to 180, and ",(0,a.jsx)(t.code,{children:"OneWay"})," property ticked"]}),"\n",(0,a.jsxs)(t.li,{children:['Set its layer to "Obstacles". Even though ',(0,a.jsx)(t.code,{children:"Obstacles"})," parent GameObject has its layer set as ",(0,a.jsx)(t.code,{children:"Obstacles"}),", this does not automatically propagate to its children all the time."]}),"\n"]}),"\n",(0,a.jsx)(o.A,{path:n(23361).A,widthPercentage:"100%"}),"\n",(0,a.jsxs)(t.admonition,{type:"playtest",children:[(0,a.jsx)(t.mdxAdmonitionTitle,{}),(0,a.jsxs)(t.p,{children:["Try jumping onto the brick and onto the platform from right underneath the platform. You should notice that Mario can\u2019t jump onto the brick from underneath it, while he can do so on the platform.\nYou shall experiment with other effectors and their properties as well so that you know what features are supported or suitable for your game idea: some kind of boost, buoyancy, etc. Effectors is what you can use if you try to implement a ",(0,a.jsx)(t.strong,{children:"pinball"})," game with many different areas that can affect the kinematics of the ball ."]})]}),"\n",(0,a.jsx)(t.h3,{id:"physicsjoint2d",children:"PhysicsJoint2D"}),"\n",(0,a.jsxs)(t.p,{children:["The question boxes should bounce when Mario collides with it from below, then turn into an empty box. We can do this easily by creating an Animation Clip, but where's the fun in that? Let's simulate it with a spring. Unity provides us with various useful ",(0,a.jsx)(t.strong,{children:"joints"}),". It will save you so much time if you want to implement any basic joints: hinge, spring, slider, wheel, etc."]}),"\n",(0,a.jsx)(t.h3,{id:"springy-question-box",children:"Springy Question Box"}),"\n",(0,a.jsxs)(t.p,{children:["Unpack one of the Question Box prefabs on your scene, then create a parent GameObject to it (name it ",(0,a.jsx)(t.code,{children:"Question-Box-Spring"})," or whatever you like) as follows, with ",(0,a.jsx)(t.code,{children:"RigidBody2D"})," set to ",(0,a.jsx)(t.code,{children:"Static"})," body type. This will be the ",(0,a.jsx)(t.strong,{children:"anchor"})," of your spring."]}),"\n",(0,a.jsx)(o.A,{path:n(81071).A,widthPercentage:"100%"}),"\n",(0,a.jsxs)(t.p,{children:["Then, add ",(0,a.jsx)(t.code,{children:"RigidBody2D"})," to the question box. Also make sure that its Transform position is at ",(0,a.jsx)(t.code,{children:"(0,0,0)"})," (means no relative coordinate wrt parent object). ",(0,a.jsx)("span",{className:"orange-bold",children:"This is important to set your spring Anchor properly later"}),". Enable ",(0,a.jsx)(t.code,{children:"Auto Mass"})," to reduce our headache in deciding what the box's mass should be, let Unity standardize it based on the size of the Collider2D element attached to the GameObject. Finally, ",(0,a.jsx)(t.strong,{children:"constant"})," ",(0,a.jsx)(t.code,{children:"X"})," position and ",(0,a.jsx)(t.code,{children:"Z"})," rotation. We only want our box to bounce up and down along the Y-axis."]}),"\n",(0,a.jsxs)(t.p,{children:["Then, add ",(0,a.jsx)(t.code,{children:"SpringJoint2D"})," component, and set the properties as follows:"]}),"\n",(0,a.jsx)(o.A,{path:n(86475).A,widthPercentage:"100%"}),"\n",(0,a.jsx)(t.p,{children:"Here's a further explanation:"}),"\n",(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsxs)(t.li,{children:["We connect the spring to parent's static Rigidbody, and ",(0,a.jsx)(t.strong,{children:"disable"}),' collision with it (we want to have an "invisible" anchor, we don\'t want our box to collide with it)']}),"\n",(0,a.jsxs)(t.li,{children:["We set the ",(0,a.jsx)(t.code,{children:"Connected Anchor"})," at ",(0,a.jsx)(t.code,{children:"(0,1)"})," (this is local position, or in other words: the position of the anchor relative to the connected Rigidbody's transform). That means to set the anchor of the spring to the connected Rigidbody in ",(0,a.jsx)(t.code,{children:"Question-Box-Bounce"})," at 1 unit away in the y-axis direction from ",(0,a.jsx)(t.code,{children:"Question-Box-Bounce"}),"'s position on the Scene."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"Distance"})," is set to ",(0,a.jsx)(t.code,{children:"1"})," because we don't want the spring to shorten once the game starts"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"Frequency"})," and ",(0,a.jsx)(t.code,{children:"Damping Ratio"}),' affects the "feel" of the spring']}),"\n"]}),"\n",(0,a.jsxs)(t.admonition,{type:"playtest",children:[(0,a.jsxs)(t.p,{children:["You should try out different property values for ",(0,a.jsx)(t.code,{children:"Frequency"})," and ",(0,a.jsx)(t.code,{children:"Damping Ratio"})," to get the right feel:"]}),(0,a.jsx)(r.A,{path:"https://50033.s3.ap-southeast-1.amazonaws.com/week-2/bouncy.mp4",widthPercentage:"100%"})]}),"\n",(0,a.jsx)(t.admonition,{type:"warning",children:(0,a.jsxs)(t.p,{children:[(0,a.jsx)("span",{className:"orange-bold",children:"Note that all values in the inspector that you change during Play mode will disappear"}),". Make sure you only change these variables for testing purposes only, and set it later after you stop the game."]})}),"\n",(0,a.jsxs)(t.p,{children:["Once you are satisfied, set ",(0,a.jsx)(t.code,{children:"Question-Box-Bounce"})," as a prefab."]}),"\n",(0,a.jsx)(t.h3,{id:"physics-material-2d",children:"Physics Material 2D"}),"\n",(0,a.jsxs)(t.p,{children:["We can ",(0,a.jsx)(t.strong,{children:"create"})," a Physics Material to adjust the friction and bounce of 2D objects when they collide, then ",(0,a.jsx)(t.strong,{children:"attach"}),' it to our collider. We don\'t really need it in this game, but for demonstration purposes, lets create some "bouncy cloud" (called ',(0,a.jsx)(t.a,{href:"https://mario.fandom.com/wiki/Lakitu%27s_Cloud",children:"Lakitu's cloud"}),") for Mario. Create a new ",(0,a.jsx)(t.code,{children:"Materials"})," folder in the Project Window. Then, right click and select Create >> 2D >> Physics Material 2D:"]}),"\n",(0,a.jsx)(o.A,{path:n(90199).A,widthPercentage:"50%"}),"\n",(0,a.jsxs)(t.p,{children:["Set the newly created material ",(0,a.jsx)(t.code,{children:"Bounciness"})," to ",(0,a.jsx)(t.code,{children:"1"})," (max value is 1, no loss of energy). Then, create a GameObject called ",(0,a.jsx)(t.code,{children:"Bouncy-Cloud"})," (",(0,a.jsx)(t.a,{href:"https://www.dropbox.com/scl/fi/kcyt9b3b2aqvq3oa0jpv0/lakitus-cloud.png?rlkey=bn9udbz2zcc68w3zounykpdhg&dl=0",children:"download the Sprite here"}),") with the following components and Layer. Hook up your newly created bouncy material in its Collider:"]}),"\n",(0,a.jsx)(o.A,{path:n(14497).A,widthPercentage:"100%"}),"\n",(0,a.jsxs)(t.admonition,{type:"playtest",children:[(0,a.jsx)(t.p,{children:"Well, that's a bouncy cloud."}),(0,a.jsx)(r.A,{path:"https://50033.s3.ap-southeast-1.amazonaws.com/week-2/bouncy-cloud.mp4",widthPercentage:"100%"})]})]})}function u(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(p,{...e})}):p(e)}},89594:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/2023-08-04-09-52-37-84ecaf85bb7fb97f1cf6c74e5ad318d0.png"},4428:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/2023-08-04-10-13-41-574c80c00894b2d89e37f9dc37edcd87.png"},3465:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/2023-08-05-10-33-49-43186b1e59d1c69c4b5e2c3516462d75.png"},69524:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/2023-08-05-10-38-05-6859398fa250609a03964272f3e8efa3.png"},56584:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/2023-08-05-10-55-40-624bfeaea856bcc9c266ac50f96f67f5.png"},7541:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/2023-08-05-11-27-12-7eed1d6ab10ea226c50a558e750907ef.png"},23361:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/2023-08-05-12-59-58-e40d035041a8adc16be014eddf54690d.png"},64258:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/2023-08-05-13-06-23-67105d27103b4b197477812dc0c05450.png"},81071:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/2023-08-05-13-15-48-2637445f51859d3ff39c126fbcf0fedf.png"},86475:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/2023-08-05-13-18-18-6a3288962475f402056887e110960987.png"},90199:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/2023-08-05-13-44-06-eb97cfb1337dd1f5bb8f0b9ec34169d5.png"},14497:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/2023-08-05-13-46-46-ea0977315d50333c7352c21d13fed1e6.png"}}]);